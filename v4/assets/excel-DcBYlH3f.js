import{r as u,j as e,G as te,i as b,c as se,R as ne}from"./invoice-extraction-config-BU6nDqXt.js";const ie=()=>{const[g,_]=u.useState([]),[k,O]=u.useState(!1),[h,v]=u.useState(null),[$,c]=u.useState(null),[w,N]=u.useState(""),[m,S]=u.useState("gemini-2.0-flash-exp"),[U,f]=u.useState(!1),[I,T]=u.useState(""),G=u.useRef(null);u.useEffect(()=>{if(typeof Office<"u")Office.onReady(()=>{W()});else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("gemini_model");t&&N(t),s&&S(s),t||f(!0)}},[]);const W=()=>{try{if(typeof Office<"u"&&Office.context&&Office.context.roamingSettings){const t=Office.context.roamingSettings.get("gemini_api_key"),s=Office.context.roamingSettings.get("gemini_model");t&&N(t),s&&S(s),t||f(!0)}else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("gemini_model");t&&N(t),s&&S(s),t||f(!0)}}catch(t){console.error("Error loading API keys:",t),f(!0)}},z=(t,s)=>{try{typeof Office<"u"&&Office.context&&Office.context.roamingSettings?(t&&Office.context.roamingSettings.set("gemini_api_key",t),Office.context.roamingSettings.set("gemini_model",s),Office.context.roamingSettings.saveAsync()):(t&&localStorage.setItem("gemini_api_key",t),localStorage.setItem("gemini_model",s)),t&&N(t),S(s),f(!1),c(null)}catch(n){console.error("Error saving API keys:",n),c("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ API –∫–ª—é—á–∞. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.")}},K=t=>{const s=t.target.files;if(!s||s.length===0)return;const n=[];for(let i=0;i<s.length;i++){const a=s[i];let o=null;if(a.type.startsWith("image/")){const l=new FileReader;l.onload=r=>{var d;o=(d=r.target)==null?void 0:d.result},l.readAsDataURL(a)}n.push({file:a,preview:o})}_(i=>[...i,...n]),v(null),c(null)},q=t=>{_(s=>s.filter((n,i)=>i!==t))},D=()=>{_([]),v(null),c(null),G.current&&(G.current.value="")},J=t=>{var a,o;const s=(a=b.extractionSettings)==null?void 0:a.delimiter,n=(o=b.extractionSettings)==null?void 0:o.minimumColumns,i=b.columns.slice(0,n).map((l,r)=>`${r+1}. ${l.name} - ${l.description}`).join(`
`);return`–¢–∏ —Å–∏ –µ–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ CSV —Ñ–∞–π–ª–æ–≤–µ –∑–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ü–ª—é—Å –ú–∏–Ω—É—Å.

–í–ê–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è (–ï–ò–ö_–§–ò–†–ú–ê): ${t}
- –ò–∑–ø–æ–ª–∑–≤–∞–π —Ç–æ–∑–∏ –ï–ò–ö, –∑–∞ –¥–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—à –¥–∞–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ –ø—Ä–æ–¥–∞–∂–±–∞ –∏–ª–∏ –ø–æ–∫—É–ø–∫–∞.

–û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê –¢–ò–ü –î–û–ö–£–ú–ï–ù–¢:
1. –ù–∞–º–µ—Ä–∏ –ï–ò–ö –Ω–∞ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
2. –ù–∞–º–µ—Ä–∏ –ï–ò–ö –Ω–∞ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
3. –°—Ä–∞–≤–Ω–∏ —Å –ï–ò–ö_–§–ò–†–ú–ê (${t}):
   - –ê–∫–æ ${t} = –ï–ò–ö –Ω–∞ –ò–ó–î–ê–¢–ï–õ ‚Üí –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ –§–ê–ö–¢–£–†–ê –ü–†–û–î–ê–ñ–ë–ê.
   - –ê–∫–æ ${t} = –ï–ò–ö –Ω–∞ –ü–û–õ–£–ß–ê–¢–ï–õ ‚Üí –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ –§–ê–ö–¢–£–†–ê –ü–û–ö–£–ü–ö–ê.
   - –ê–∫–æ ${t} –ù–ï —Å–µ –Ω–∞–º–∏—Ä–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Üí –ü–†–û–ü–£–°–ù–ò —Ç–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç (–Ω–µ —Å—ä–∑–¥–∞–≤–∞–π —Ä–µ–¥–æ–≤–µ).

–í –ï–î–ò–ù PDF –ú–û–ñ–ï –î–ê –ò–ú–ê –ù–Ø–ö–û–õ–ö–û –î–û–ö–£–ú–ï–ù–¢–ê:
- –û–±—Ä–∞–±–æ—Ç–≤–∞–π –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–æ—Ç–¥–µ–ª–Ω–æ.
- –ó–∞ –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç —Å—ä–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª–Ω–∏ —Ä–µ–¥–æ–≤–µ –≤ CSV.

–ï–î–ò–ù CSV –†–ï–î = –ï–î–ù–ê –ü–û–ó–ò–¶–ò–Ø –û–¢ –î–û–ö–£–ú–ï–ù–¢–ê:
- –ó–∞ –í–°–Ø–ö–ê –ü–û–ó–ò–¶–ò–Ø (–∞—Ä—Ç–∏–∫—É–ª, —Ä–µ–¥ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∞—Ç–∞) —Å—ä–∑–¥–∞–π –æ—Ç–¥–µ–ª–µ–Ω —Ä–µ–¥.
- –ù–∞—á–∞–ª–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ (–∫–æ–ª–æ–Ω–∏ 1‚Äì${n}) —Å–∞ –µ–¥–Ω–∞–∫–≤–∏ –∑–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–¥–æ–≤–µ –æ—Ç –µ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç.
- –ü–æ–ª–µ—Ç–∞—Ç–∞ –∑–∞ –æ–±—â–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–û–±—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –î–î–°, –ü–ª–∞—Ç–µ–Ω–æ –∏ —Ç.–Ω.) —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

CSV –§–û–†–ú–ê–¢:
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ –∫–æ–ª–æ–Ω–∏: "${s}"
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ —Ä–µ–¥–æ–≤–µ: –Ω–æ–≤ —Ä–µ–¥ (\\n –∏–ª–∏ \\r\\n)
- –ë–ï–ó –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥.
- –í—Å–µ–∫–∏ —Ä–µ–¥ = –ï–î–ù–ê –ø–æ–∑–∏—Ü–∏—è (–∞—Ä—Ç–∏–∫—É–ª) –æ—Ç –¥–∞–¥–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç.

–ö–û–õ–û–ù–ò (–ú–ò–ù–ò–ú–£–ú ${n} –∫–æ–ª–æ–Ω–∏):
${i}

–í–ê–ñ–ù–ò –ü–†–ê–í–ò–õ–ê:
1. –í–ò–ù–ê–ì–ò –∏–∑–≤–µ–∂–¥–∞–π –ú–ò–ù–ò–ú–£–ú ${n} –∫–æ–ª–æ–Ω–∏ (1‚Äì${n}).
2. –ê–∫–æ –∏–º–∞—à –Ω–∞–¥–µ–∂–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–æ–Ω–∏ —Å–ª–µ–¥ ${n}, –¥–æ–±–∞–≤–∏ –≥–∏ (–¥–æ –º–∞–∫—Å–∏–º—É–º ${b.columns.length} –∫–æ–ª–æ–Ω–∏).
3. –ê–∫–æ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ —è –ø—Ä–∞–∑–Ω–∞ (–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ "${s}").
4. –ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞, –∞ –Ω–µ —Ñ–∏—Ä–º–∞—Ç–∞ —Å –ï–ò–ö_–§–ò–†–ú–ê.
5. –ê–∫–æ –ï–ò–ö_–§–ò–†–ú–ê (${t}) –ù–ï —Å–µ –Ω–∞–º–∏—Ä–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –ù–ï –∏–∑–≤–µ–∂–¥–∞–π —Ä–µ–¥–æ–≤–µ –∑–∞ –Ω–µ–≥–æ.
6. –î–∞—Ç–∏—Ç–µ —Å–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy.
7. –ß–∏—Å–ª–∞—Ç–∞ —Å–∞ –±–µ–∑ –≤–∞–ª—É—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏.
8. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\ & –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞.

–î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ò–ù–°–¢–†–£–ö–¶–ò–ò:
${b.extractionInstructions.map((l,r)=>`${r+1}. ${l}`).join(`
`)}

–ò–ó–•–û–î:
–í—ä—Ä–Ω–∏ –°–ê–ú–û CSV –¥–∞–Ω–Ω–∏—Ç–µ, –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç, –æ–±—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ markdown.
–ó–∞–ø–æ—á–Ω–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å —Ä–µ–¥/—Ä–µ–¥–æ–≤–µ —Å –¥–∞–Ω–Ω–∏ (–ë–ï–ó –∑–∞–≥–ª–∞–≤–∏—è).
–í—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –ú–ò–ù–ò–ú–£–ú ${n} —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–∫–æ–ª–æ–Ω–∏), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏ —Å "${s}".
–ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –Ω–µ —Å—ä–¥—ä—Ä–∂–∞ –ï–ò–ö ${t}, –Ω–µ –∏–∑–≤–µ–∂–¥–∞–π –Ω–∏—â–æ –∑–∞ –Ω–µ–≥–æ.`},H=async()=>{var n,i,a,o,l,r,d,V;if(g.length===0)return;if(!I.trim()){c("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞.");return}if(!w){c("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á."),f(!0);return}O(!0),c(null),v(null);const t=(n=b.extractionSettings)==null?void 0:n.delimiter,s=(i=b.extractionSettings)==null?void 0:i.minimumColumns;try{const y=[];for(let C=0;C<g.length;C++){const{file:E}=g[C],F=new FileReader,L=await new Promise((x,p)=>{F.onload=j=>{var B;const R=((B=j.target)==null?void 0:B.result).split(",")[1];x(R)},F.onerror=p,F.readAsDataURL(E)}),M=J(I.trim());let P="";if(m==="gemini-2.5-flash"||m==="gemini-2.5-pro"){const x=`https://generativelanguage.googleapis.com/v1/models/${m}:generateContent?key=${w}`,p={contents:[{parts:[{text:M},{inline_data:{mime_type:E.type,data:L}}]}]},j=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!j.ok){const R=await j.json();throw new Error(`Gemini API error: ${((a=R.error)==null?void 0:a.message)||j.statusText}`)}P=((V=(d=(r=(l=(o=(await j.json()).candidates)==null?void 0:o[0])==null?void 0:l.content)==null?void 0:r.parts)==null?void 0:d[0])==null?void 0:V.text)||""}else P=((await new te({apiKey:w}).chats.create({model:m}).sendMessage({message:[{text:M},{inlineData:{mimeType:E.type,data:L}}]})).text||"").trim();let A=P.trim();A.startsWith("```")&&(A=A.replace(/```csv\n?/gi,"").replace(/```\n?/g,"").trim());const Z=A.split(/\r?\n/).map(x=>x.trim()).filter(x=>x.length>0);for(const x of Z){const p=x.split(t);for(;p.length<s;)p.push("");y.push(p)}}if(y.length===0)c("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —Å —Ç–æ–∑–∏ –ï–ò–ö –∏–ª–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏ —Å–∞ –ø—Ä–∞–∑–Ω–∏."),v(null);else{const C=`invoices_${Date.now()}.csv`;v({rows:y,fileName:C})}}catch(y){console.error(y),c(y instanceof Error?y.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ.")}finally{O(!1)}},Q=async()=>{if(!(!h||!h.rows.length))try{if(typeof Excel>"u"){c("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{const s=t.workbook.getActiveWorksheet(),n=h.rows,i=n.length,a=n.reduce((r,d)=>Math.max(r,d.length),0),o=n.map(r=>{const d=[...r];for(;d.length<a;)d.push("");return d}),l=s.getRangeByIndexes(0,0,i,a);l.values=o,l.format.autofitColumns(),l.format.autofitRows(),await t.sync()})}catch(t){console.error(t),c(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤–º—ä–∫–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel.")}},X=()=>{var o;if(!h)return;const t=(o=b.extractionSettings)==null?void 0:o.delimiter,s=h.rows.map(l=>l.join(t)).join(`\r
`),n=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),a=URL.createObjectURL(n);i.setAttribute("href",a),i.setAttribute("download",h.fileName),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)};if(U){const t=m==="gemini-2.0-flash-exp"?"Gemini 2.0 Flash":m==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro";return e.jsx("div",{className:"max-w-xl mx-auto p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ Gemini API"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"–í—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á –∏ –∏–∑–±–µ—Ä–µ—Ç–µ –º–æ–¥–µ–ª. –ö–ª—é—á—ä—Ç —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ roaming settings (–≤ Excel) –∏–ª–∏ –≤ localStorage (–≤ –±—Ä–∞—É–∑—ä—Ä–∞)."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini –º–æ–¥–µ–ª:"}),e.jsxs("select",{value:m,onChange:s=>S(s.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"gemini-2.0-flash-exp",children:"Gemini 2.0 Flash ‚Äì –±—ä—Ä–∑ –∏ –µ–≤—Ç–∏–Ω"}),e.jsx("option",{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash ‚Äì –ø–æ–¥–æ–±—Ä–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç"}),e.jsx("option",{value:"gemini-2.5-pro",children:"Gemini 2.5 Pro ‚Äì –Ω–∞–π-—Ç–æ—á–µ–Ω"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["–¢–µ–∫—É—â –º–æ–¥–µ–ª: ",e.jsx("span",{className:"text-blue-300",children:t})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini API –∫–ª—é—á:"}),e.jsx("input",{type:"password",value:w,onChange:s=>N(s.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),$&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-500 rounded",children:e.jsx("p",{className:"text-xs text-red-200",children:$})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>z(w,m),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"–ó–∞–ø–∞–∑–∏"}),w&&e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium",children:"–ü—Ä–æ–¥—ä–ª–∂–∏"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-500 rounded text-xs text-blue-200",children:[e.jsx("strong",{children:"–°—ä–≤–µ—Ç:"})," Gemini 2.0 Flash –µ –ø–æ–¥—Ö–æ–¥—è—â –∑–∞ –º–∞—Å–æ–≤–æ –æ–±—Ä–∞–±–æ—Ç–≤–∞–Ω–µ; 2.5 Pro ‚Äì –∑–∞ —Å–ª–æ–∂–Ω–∏, —Ä—ä–∫–æ–ø–∏—Å–Ω–∏ –∏ –¥—ä–ª–≥–∏ —Ñ–∞–∫—Ç—É—Ä–∏."]})]})})}const Y=m==="gemini-2.0-flash-exp"?"Gemini 2.0 Flash":m==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro";return e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ (Excel)"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["–ú–æ–¥–µ–ª:"," ",e.jsxs("span",{className:"text-blue-400 font-medium",children:["ü§ñ ",Y]})]})]}),e.jsx("button",{onClick:()=>f(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"‚öôÔ∏è API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ö–∞—á–µ—Ç–µ –µ–¥–∏–Ω –∏–ª–∏ –ø–æ–≤–µ—á–µ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ñ–∞–∫—Ç—É—Ä–∏. –î–∞–Ω–Ω–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –¥–æ —Ä–µ–¥–æ–≤–µ, –≥–æ—Ç–æ–≤–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ (–ï–ò–ö_–§–ò–†–ú–ê): ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:I,onChange:t=>T(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ –ï–ò–ö –Ω–∞ –≤–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞.",className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:k}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ï–ò–ö-—ä—Ç —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—è–Ω–µ –¥–∞–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ —Ñ–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞ –∏–ª–∏ —Ñ–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:G,type:"file",multiple:!0,accept:"image/*,pdf",onChange:K,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=G.current)==null?void 0:t.click()},disabled:k,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:g.length>0?"–î–æ–±–∞–≤–∏ –æ—â–µ —Ñ–∞–π–ª–æ–≤–µ":"–ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ"})]}),g.length>0&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium",children:["–ò–∑–±—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ (",g.length,")"]}),e.jsx("button",{onClick:D,className:"text-red-400 hover:text-red-300 text-sm",children:"–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏"})]}),g.map((t,s)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.file.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.file.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:()=>q(s),className:"text-red-400 hover:text-red-300 text-sm",children:"–ü—Ä–µ–º–∞—Ö–Ω–∏"})]}),t.preview&&e.jsx("img",{src:t.preview,alt:"Preview",className:"max-w-full max-h-48 rounded-lg mx-auto"})]},s))]}),g.length>0&&!h&&e.jsx("button",{onClick:H,disabled:k,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:k?`–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ‚Ä¶ (${g.length} —Ñ–∞–π–ª–∞)`:"–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏"}),$&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-200 text-sm",children:$})}),h&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-900 rounded-lg",children:[e.jsxs("p",{className:"text-gray-200 text-sm mb-2",children:["–ò–∑–≤–ª–µ—á–µ–Ω–∏ —Ä–µ–¥–æ–≤–µ: ",h.rows.length]}),e.jsx("p",{className:"text-gray-500 text-xs",children:"–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –≥–æ—Ç–æ–≤–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel –æ—Ç –∫–ª–µ—Ç–∫–∞ A1."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:Q,className:"flex-1 min-w-[150px] py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"–í–º—ä–∫–Ω–∏ –≤ Excel"}),e.jsx("button",{onClick:X,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"–ò–∑—Ç–µ–≥–ª–∏ CSV (debug)"}),e.jsx("button",{onClick:D,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-700 hover:bg-gray-800 text-white rounded-lg font-medium transition-colors",children:"–ù–æ–≤ –∞–Ω–∞–ª–∏–∑"})]})]})]})})},le=se.createRoot(document.getElementById("root"));le.render(e.jsx(ne.StrictMode,{children:e.jsx("div",{className:"bg-gray-900 text-gray-200 h-full antialiased overflow-y-auto",children:e.jsx(ie,{})})}));
