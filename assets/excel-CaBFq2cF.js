import{i as g,r as h,j as e,G as ie,c as ae,R as oe}from"./invoice-extraction-config-ppP7IdiS.js";const U=7;var K;const re=((K=g.columns.find(x=>x.columnNumber===8))==null?void 0:K.allowedValues)||["–°–¢–û–ö–ò","–£–°–õ–£–ì–ò","–ú–ê–¢–ï–†–ò–ê–õ–ò","–ü–†–û–î–£–ö–¶–ò–Ø","–†–ê–ó–•–û–î–ò –ó–ê –ú–ê–¢–ï–†–ò–ê–õ–ò","–ê–í–ê–ù–°","–ü–†–ò–°–ü–ê–í–ê–ù–°"],ce=()=>{const[x,_]=h.useState([]),[$,O]=h.useState(!1),[m,E]=h.useState(null),[G,u]=h.useState(null),[S,I]=h.useState(""),[p,k]=h.useState("gemini-2.0-flash-exp"),[W,j]=h.useState(!1),[R,Y]=h.useState("1"),[L,z]=h.useState("–°–¢–û–ö–ò"),A=h.useRef(null);h.useEffect(()=>{if(typeof Office<"u")Office.onReady(()=>{J()});else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("gemini_model");t&&I(t),s&&k(s),t||j(!0)}},[]);const J=()=>{try{if(typeof Office<"u"&&Office.context&&Office.context.roamingSettings){const t=Office.context.roamingSettings.get("gemini_api_key"),s=Office.context.roamingSettings.get("gemini_model");t&&I(t),s&&k(s),t||j(!0)}else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("gemini_model");t&&I(t),s&&k(s),t||j(!0)}}catch(t){console.error("Error loading API keys:",t),j(!0)}},q=(t,s)=>{try{typeof Office<"u"&&Office.context&&Office.context.roamingSettings?(t&&Office.context.roamingSettings.set("gemini_api_key",t),Office.context.roamingSettings.set("gemini_model",s),Office.context.roamingSettings.saveAsync()):(t&&localStorage.setItem("gemini_api_key",t),localStorage.setItem("gemini_model",s)),t&&I(t),k(s),j(!1),u(null)}catch(l){console.error("Error saving API keys:",l),u("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ API –∫–ª—é—á–∞. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.")}},X=t=>{const s=t.target.files;if(!s||s.length===0)return;const l=[];for(let n=0;n<s.length;n++){const o=s[n];let d=null;if(o.type.startsWith("image/")){const a=new FileReader;a.onload=y=>{var f;d=(f=y.target)==null?void 0:f.result},a.readAsDataURL(o)}l.push({file:o,preview:d})}_(n=>[...n,...l]),E(null),u(null)},H=t=>{_(s=>s.filter((l,n)=>n!==t))},T=()=>{_([]),E(null),u(null),A.current&&(A.current.value="")},Q=(t,s)=>{var f,v;const l=(f=g.extractionSettings)==null?void 0:f.delimiter,n=(v=g.extractionSettings)==null?void 0:v.minimumColumns,o=g.columns.slice(0,n).map((r,c)=>`${c+1}. ${r.name} - ${r.description}`).join(`
`),a={1:"–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞",2:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",3:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",4:"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞",5:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",6:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",7:"–ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏",8:"–¢—Ä–∞–Ω—Å—Ñ–µ—Ä",9:"–ë—Ä–∞–∫ (–†–ê–ó–•–û–î)",10:"–ë—Ä–∞–∫ (–ú–û–õ)",11:"–°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ",12:"–°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)",13:"–°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)",14:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏",15:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}[t]||"",y=`
–õ–û–ì–ò–ö–ê –ó–ê –û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê –ü–ê–†–¢–ù–¨–û–†–ê –°–ü–û–†–ï–î –í–ò–î. –î–û–ö–£–ú–ï–ù–¢ (${t}${a?` ‚Äì ${a}`:""}):

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 1, 2, 3 –∏–ª–∏ 7 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞, –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß (–∫–ª–∏–µ–Ω—Ç—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 4, 5 –∏–ª–∏ 6 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö (–¥–æ—Å—Ç–∞–≤—á–∏–∫—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ –æ—Ç 8 –¥–æ 15:
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç —Å—ä–¥—ä—Ä–∂–∞ –≤—ä–Ω—à–µ–Ω –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–¥—Ä—É–≥–∞ —Ñ–∏—Ä–º–∞ –∏–∑–≤—ä–Ω –Ω–∞—à–∞—Ç–∞) ‚Äì –∏–∑–ø–æ–ª–∑–≤–∞–π –Ω–µ–≥–æ –∫–∞—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6).
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ —á–∏—Å—Ç–æ –≤—ä—Ç—Ä–µ—à–µ–Ω (–º–µ–∂–¥—É –Ω–∞—à–∏ —Å–∫–ª–∞–¥–æ–≤–µ/–æ–±–µ–∫—Ç–∏) ‚Äì –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∏ 4‚Äì6 –ø—Ä–∞–∑–Ω–∏.

–ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –í–ò–ù–ê–ì–ò –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞), –∞ –Ω–µ –Ω–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞.
`.trim();return`–¢–∏ —Å–∏ –µ–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ CSV —Ñ–∞–π–ª–æ–≤–µ –∑–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ü–ª—é—Å –ú–∏–Ω—É—Å.

–í–ê–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${t}${a?` ‚Äì ${a}`:""}
- –¢–æ–∑–∏ –Ω–æ–º–µ—Ä –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ö–û–õ–û–ù–ê 1 (–ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.
- –í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${s}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 8 (–í–∏–¥) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.

${y}

–í –ï–î–ò–ù PDF –ú–û–ñ–ï –î–ê –ò–ú–ê –ù–Ø–ö–û–õ–ö–û –î–û–ö–£–ú–ï–ù–¢–ê:
- –û–±—Ä–∞–±–æ—Ç–≤–∞–π –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–æ—Ç–¥–µ–ª–Ω–æ.
- –ó–∞ –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç —Å—ä–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª–Ω–∏ —Ä–µ–¥–æ–≤–µ –≤ CSV.

–ï–î–ò–ù CSV –†–ï–î = –ï–î–ù–ê –ü–û–ó–ò–¶–ò–Ø –û–¢ –î–û–ö–£–ú–ï–ù–¢–ê:
- –ó–∞ –í–°–Ø–ö–ê –ü–û–ó–ò–¶–ò–Ø (–∞—Ä—Ç–∏–∫—É–ª, —Ä–µ–¥ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∞—Ç–∞) —Å—ä–∑–¥–∞–π –æ—Ç–¥–µ–ª–µ–Ω —Ä–µ–¥.
- –ù–∞—á–∞–ª–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ (–∫–æ–ª–æ–Ω–∏ 1‚Äì${n}) —Å–∞ –µ–¥–Ω–∞–∫–≤–∏ –∑–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–¥–æ–≤–µ –æ—Ç –µ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç.
- –ü–æ–ª–µ—Ç–∞—Ç–∞ –∑–∞ –æ–±—â–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–û–±—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –î–î–°, –ü–ª–∞—Ç–µ–Ω–æ –∏ —Ç.–Ω.) —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

CSV –§–û–†–ú–ê–¢:
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ –∫–æ–ª–æ–Ω–∏: "${l}"
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ —Ä–µ–¥–æ–≤–µ: CRLF (\\r\\n)
- –ë–ï–ó –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥.
- –í—Å–µ–∫–∏ —Ä–µ–¥ = –ï–î–ù–ê –ø–æ–∑–∏—Ü–∏—è (–∞—Ä—Ç–∏–∫—É–ª) –æ—Ç –¥–∞–¥–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç.

–ö–û–õ–û–ù–ò (–ú–ò–ù–ò–ú–£–ú ${n} –∫–æ–ª–æ–Ω–∏):
${o}

–í–ê–ñ–ù–ò –ü–†–ê–í–ò–õ–ê:
1. –ö–û–õ–û–ù–ê 1 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –Ω–æ–º–µ—Ä–∞ –Ω–∞ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç: ${t}
2. –ö–û–õ–û–ù–ê 8 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –≤–∏–¥–∞ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ${s}
3. –í–ò–ù–ê–ì–ò –∏–∑–≤–µ–∂–¥–∞–π –ú–ò–ù–ò–ú–£–ú ${n} –∫–æ–ª–æ–Ω–∏ (1‚Äì${n}).
3. –ê–∫–æ –∏–º–∞—à –Ω–∞–¥–µ–∂–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–æ–Ω–∏ —Å–ª–µ–¥ ${n}, –¥–æ–±–∞–≤–∏ –≥–∏ (–¥–æ –º–∞–∫—Å–∏–º—É–º ${g.columns.length} –∫–æ–ª–æ–Ω–∏).
4. –ê–∫–æ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ —è –ø—Ä–∞–∑–Ω–∞ (–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ "${l}").
5. –ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞).

6. –î–∞—Ç–∏—Ç–µ —Å–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy.
7. –ß–∏—Å–ª–∞—Ç–∞ —Å–∞ –±–µ–∑ –≤–∞–ª—É—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏.
8. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\ & –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞.

–î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ò–ù–°–¢–†–£–ö–¶–ò–ò:
${g.extractionInstructions.map((r,c)=>`${c+1}. ${r}`).join(`
`)}

–ò–ó–•–û–î:
–í—ä—Ä–Ω–∏ –°–ê–ú–û CSV –¥–∞–Ω–Ω–∏—Ç–µ, –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç, –æ–±—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ markdown.
–ó–∞–ø–æ—á–Ω–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å —Ä–µ–¥/—Ä–µ–¥–æ–≤–µ —Å –¥–∞–Ω–Ω–∏ (–ë–ï–ó –∑–∞–≥–ª–∞–≤–∏—è).
–í—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –ú–ò–ù–ò–ú–£–ú ${n} —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–∫–æ–ª–æ–Ω–∏), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏ —Å "${l}".
–ö–û–õ–û–ù–ê 1 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${t}
–ö–û–õ–û–ù–ê 8 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${s}`},Z=async()=>{var l,n,o,d,a,y,f,v;if(x.length===0)return;if(!R){u("–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç.");return}if(!S){u("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á."),j(!0);return}O(!0),u(null),E(null);const t=(l=g.extractionSettings)==null?void 0:l.delimiter,s=(n=g.extractionSettings)==null?void 0:n.minimumColumns;try{const r=[];for(let c=0;c<x.length;c++){const{file:i}=x[c],N=new FileReader,M=await new Promise((b,w)=>{N.onload=C=>{var B;const D=((B=C.target)==null?void 0:B.result).split(",")[1];b(D)},N.onerror=w,N.readAsDataURL(i)}),V=Q(R,L);let P="";if(p==="gemini-2.5-flash"||p==="gemini-2.5-pro"){const b=`https://generativelanguage.googleapis.com/v1/models/${p}:generateContent?key=${S}`,w={contents:[{parts:[{text:V},{inline_data:{mime_type:i.type,data:M}}]}]},C=await fetch(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!C.ok){const D=await C.json();throw new Error(`Gemini API error: ${((o=D.error)==null?void 0:o.message)||C.statusText}`)}P=((v=(f=(y=(a=(d=(await C.json()).candidates)==null?void 0:d[0])==null?void 0:a.content)==null?void 0:y.parts)==null?void 0:f[0])==null?void 0:v.text)||""}else P=((await new ie({apiKey:S}).chats.create({model:p}).sendMessage({message:[{text:V},{inlineData:{mimeType:i.type,data:M}}]})).text||"").trim();let F=P.trim();F.startsWith("```")&&(F=F.replace(/```csv\n?/gi,"").replace(/```\n?/g,"").trim());const ne=F.split(/\r?\n/).map(b=>b.trim()).filter(b=>b.length>0);for(const b of ne){const w=b.split(t);for(;w.length<s;)w.push("");r.push(w)}}if(r.length===0)u("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ –∏–ª–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –µ –ø—Ä–∞–∑–µ–Ω."),E(null);else{const c=`invoices_${Date.now()}.csv`;E({rows:r,fileName:c})}}catch(r){console.error(r),u(r instanceof Error?r.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ.")}finally{O(!1)}},ee=async()=>{if(!(!m||!m.rows.length))try{if(typeof Excel>"u"){u("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{const s=t.workbook.worksheets.getActiveWorksheet();let l=0,n=!1;try{const i=s.getUsedRange();i.load(["rowCount","rowIndex"]),await t.sync(),i.rowCount===0?(n=!0,l=0):l=i.rowIndex+i.rowCount}catch{l=0,n=!0}const o=m.rows,d=o.length,a=Math.max(...o.map(i=>i.length)),y=g.columns.slice(0,a).map(i=>i.name),f=o.map(i=>{const N=[...i];for(;N.length<a;)N.push("");return N});if(n){const i=s.getRangeByIndexes(0,0,1,a);i.values=[y],i.format.font.bold=!0,i.format.fill.color="#4472C4",i.format.font.color="#FFFFFF",await t.sync(),l=1}const v=s.getRangeByIndexes(l,0,d,a);if(v.values=f,a>U){const i=s.getRangeByIndexes(l,U,d,1);i.dataValidation.clear(),i.dataValidation.rule={list:{inCellDropDown:!0,source:re.join(",")}}}v.format.autofitColumns(),await t.sync();const r=`–£—Å–ø–µ—Ö! ${d} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –Ω–∞ —Ä–µ–¥ ${l+1}.`,c=document.createElement("div");c.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",c.textContent=r,document.body.appendChild(c),setTimeout(()=>{document.body.removeChild(c)},3e3)})}catch(t){console.error(t),u(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤–º—ä–∫–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel.")}},te=()=>{var d;if(!m)return;const t=(d=g.extractionSettings)==null?void 0:d.delimiter,s=m.rows.map(a=>a.join(t)).join(`\r
`),l=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),o=URL.createObjectURL(l);n.setAttribute("href",o),n.setAttribute("download",m.fileName),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)};if(W){const t=p==="gemini-2.0-flash-exp"?"Gemini 2.0 Flash":p==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro";return e.jsx("div",{className:"max-w-xl mx-auto p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ Gemini API"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"–í—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á –∏ –∏–∑–±–µ—Ä–µ—Ç–µ –º–æ–¥–µ–ª. –ö–ª—é—á—ä—Ç —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ roaming settings (–≤ Excel) –∏–ª–∏ –≤ localStorage (–≤ –±—Ä–∞—É–∑—ä—Ä–∞)."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini –º–æ–¥–µ–ª:"}),e.jsxs("select",{value:p,onChange:s=>k(s.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"gemini-2.0-flash-exp",children:"Gemini 2.0 Flash ‚Äì –±—ä—Ä–∑ –∏ –µ–≤—Ç–∏–Ω"}),e.jsx("option",{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash ‚Äì –ø–æ–¥–æ–±—Ä–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç"}),e.jsx("option",{value:"gemini-2.5-pro",children:"Gemini 2.5 Pro ‚Äì –Ω–∞–π-—Ç–æ—á–µ–Ω"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["–¢–µ–∫—É—â –º–æ–¥–µ–ª: ",e.jsx("span",{className:"text-blue-300",children:t})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini API –∫–ª—é—á:"}),e.jsx("input",{type:"password",value:S,onChange:s=>I(s.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),G&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-500 rounded",children:e.jsx("p",{className:"text-xs text-red-200",children:G})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>q(S,p),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"–ó–∞–ø–∞–∑–∏"}),S&&e.jsx("button",{onClick:()=>j(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium",children:"–ü—Ä–æ–¥—ä–ª–∂–∏"})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-900/30 border border-blue-500 rounded text-xs text-blue-200",children:e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –º–æ–¥–µ–ª–∏—Ç–µ:"}),e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Gemini 2.0 Flash:"})," –ù–∞–π-–±—ä—Ä–∑ –∏ –µ–≤—Ç–∏–Ω (~$0.001 –Ω–∞ —Ñ–∞–∫—Ç—É—Ä–∞)",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Gemini 2.5 Flash:"})," –ü–æ–¥–æ–±—Ä–µ–Ω–∞ –≤–µ—Ä—Å–∏—è, –ø–æ-—Ç–æ—á–Ω–∞",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Gemini 2.5 Pro:"})," –ù–∞–π-–º–æ—â–µ–Ω –º–æ–¥–µ–ª, –Ω–∞–π-–≤–∏—Å–æ–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç"]})})]})})}const se=p==="gemini-2.0-flash-exp"?"Gemini 2.0 Flash":p==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro";return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ (Excel)"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["–ú–æ–¥–µ–ª:"," ",e.jsxs("span",{className:"text-blue-400 font-medium",children:["ü§ñ ",se]})]})]}),e.jsx("button",{onClick:()=>j(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"‚öôÔ∏è API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ö–∞—á–µ—Ç–µ –µ–¥–∏–Ω –∏–ª–∏ –ø–æ–≤–µ—á–µ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ñ–∞–∫—Ç—É—Ä–∏. –î–∞–Ω–Ω–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –¥–æ —Ä–µ–¥–æ–≤–µ, –≥–æ—Ç–æ–≤–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:R,onChange:t=>Y(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:$,children:[e.jsx("option",{value:"1",children:"1 - –§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"2",children:"2 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"3",children:"3 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"4",children:"4 - –§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"5",children:"5 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"6",children:"6 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"7",children:"7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏"}),e.jsx("option",{value:"8",children:"8 - –¢—Ä–∞–Ω—Å—Ñ–µ—Ä"}),e.jsx("option",{value:"9",children:"9 - –ë—Ä–∞–∫ (–†–ê–ó–•–û–î)"}),e.jsx("option",{value:"10",children:"10 - –ë—Ä–∞–∫ (–ú–û–õ)"}),e.jsx("option",{value:"11",children:"11 - –°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ"}),e.jsx("option",{value:"12",children:"12 - –°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)"}),e.jsx("option",{value:"13",children:"13 - –°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)"}),e.jsx("option",{value:"14",children:"14 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}),e.jsx("option",{value:"15",children:"15 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ò–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ù–æ–º–µ—Ä—ä—Ç —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞ –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:L,onChange:t=>z(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:$,children:[e.jsx("option",{value:"–°–¢–û–ö–ò",children:"–°–¢–û–ö–ò"}),e.jsx("option",{value:"–£–°–õ–£–ì–ò",children:"–£–°–õ–£–ì–ò"}),e.jsx("option",{value:"–ú–ê–¢–ï–†–ò–ê–õ–ò",children:"–ú–ê–¢–ï–†–ò–ê–õ–ò"}),e.jsx("option",{value:"–ü–†–û–î–£–ö–¶–ò–Ø",children:"–ü–†–û–î–£–ö–¶–ò–Ø"}),e.jsx("option",{value:"–†–ê–ó–•–û–î–ò –ó–ê –ú–ê–¢–ï–†–ò–ê–õ–ò",children:"–†–ê–ó–•–û–î–ò –ó–ê –ú–ê–¢–ï–†–ò–ê–õ–ò"}),e.jsx("option",{value:"–ê–í–ê–ù–°",children:"–ê–í–ê–ù–°"}),e.jsx("option",{value:"–ü–†–ò–°–ü–ê–í–ê–ù–°",children:"–ü–†–ò–°–ü–ê–í–ê–ù–°"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ò–∑–±–µ—Ä–µ—Ç–µ –≤–∏–¥–∞ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞. –°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 8 (–í–∏–¥) –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:A,type:"file",multiple:!0,accept:"image/*,.pdf",onChange:X,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=A.current)==null?void 0:t.click()},disabled:$,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:x.length>0?"–î–æ–±–∞–≤–∏ –æ—â–µ —Ñ–∞–π–ª–æ–≤–µ":"–ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ"})]}),x.length>0&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium",children:["–ò–∑–±—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ (",x.length,")"]}),e.jsx("button",{onClick:T,className:"text-red-400 hover:text-red-300 text-sm",children:"–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏"})]}),x.map((t,s)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.file.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.file.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:()=>H(s),className:"text-red-400 hover:text-red-300 text-sm",children:"–ü—Ä–µ–º–∞—Ö–Ω–∏"})]}),t.preview&&e.jsx("img",{src:t.preview,alt:"Preview",className:"max-w-full max-h-48 rounded-lg mx-auto"})]},s))]}),x.length>0&&!m&&e.jsx("button",{onClick:Z,disabled:$,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:$?`–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ‚Ä¶ (${x.length} —Ñ–∞–π–ª–∞)`:"–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏"}),G&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-200 text_sm",children:G})}),m&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-900/30 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-200 font-medium",children:"‚úì –î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏ —É—Å–ø–µ—à–Ω–æ!"}),e.jsxs("p",{className:"text-green-200 text-sm mt-1",children:["–ò–∑–≤–ª–µ—á–µ–Ω–∏ —Ä–µ–¥–æ–≤–µ: ",m.rows.length]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ:"}),e.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"text-xs text-gray-300 w-full border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-800",children:e.jsx("tr",{children:g.columns.slice(0,Math.max(...m.rows.map(t=>t.length))).map((t,s)=>e.jsx("th",{className:"border border-gray-600 px-2 py-2 text-left font-medium bg-gray-800",children:t.name},s))})}),e.jsx("tbody",{children:m.rows.map((t,s)=>e.jsxs("tr",{className:s%2===0?"bg-gray-800":"bg-gray-750",children:[t.map((l,n)=>e.jsx("td",{className:"border border-gray-600 px-2 py-1 max-w-[200px] truncate",title:l,children:l||"-"},n)),Array.from({length:Math.max(...m.rows.map(l=>l.length))-t.length}).map((l,n)=>e.jsx("td",{className:"border border-gray-600 px-2 py-1",children:"-"},`empty-${n}`))]},s))})]})}),e.jsx("p",{className:"text-gray-400 text-xs mt-2",children:"–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–Ω–Ω–∏—Ç–µ –ø—Ä–µ–¥–∏ –¥–∞ –≥–∏ –≤–º—ä–∫–Ω–µ—Ç–µ –≤ Excel. –ú–æ–∂–µ—Ç–µ –¥–∞ –ø—Ä–µ–≤—ä—Ä—Ç–∏—Ç–µ —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–Ω–æ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª–Ω–æ –∑–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:ee,className:"flex-1 min-w-[150px] py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"üìã –í–º—ä–∫–Ω–∏ –≤ Excel"}),e.jsx("button",{onClick:te,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"üíæ –ò–∑—Ç–µ–≥–ª–∏ CSV (debug)"}),e.jsx("button",{onClick:T,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-700 hover:bg-gray-800 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ù–æ–≤ –∞–Ω–∞–ª–∏–∑"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"–ü–æ–¥–¥—ä—Ä–∂–∞–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏:"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"‚Ä¢ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏"}),e.jsx("li",{children:"‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, WEBP)"}),e.jsx("li",{children:"‚Ä¢ –§–∞–∫—Ç—É—Ä–∏ –∑–∞ —É—Å–ª—É–≥–∏"}),e.jsx("li",{children:"‚Ä¢ –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤–µ –Ω–∞–≤–µ–¥–Ω—ä–∂"})]})]})]})},de=ae.createRoot(document.getElementById("root"));de.render(e.jsx(oe.StrictMode,{children:e.jsx("div",{className:"bg-gray-900 text-gray-200 h-full antialiased overflow-y-auto",children:e.jsx(ce,{})})}));
