import{r as n,j as e,G as T,i as E,c as O,R as U}from"./invoice-extraction-config-C6ESNmdC.js";const G="You are a helpful AI assistant named Gemini. Keep your responses concise and helpful. Format code snippets appropriately using markdown.",V=[{id:"balanced",name:"Balanced",description:"Optimal blend of speed and reasoning for most tasks.",cost:"Standard",model:"gemini-2.5-flash",config:{systemInstruction:G}},{id:"lightning",name:"Lightning",description:"Prioritizes response speed, ideal for quick queries.",cost:"Lower",model:"gemini-2.5-flash",config:{systemInstruction:G,thinkingConfig:{thinkingBudget:0}}}],z=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:[e.jsx("path",{fillRule:"evenodd",d:"M11.25 3.5A1.75 1.75 0 0 0 9.5 5.25v1.5H11v-1.5a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25v1.5h1.5v-1.5A1.75 1.75 0 0 0 12.75 3.5h-1.5Z",clipRule:"evenodd"}),e.jsx("path",{d:"M3 6.5A1.5 1.5 0 0 1 4.5 5h11A1.5 1.5 0 0 1 17 6.5v7a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 3 13.5v-7ZM4.5 6a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.5-.5h-11Z"}),e.jsx("path",{fillRule:"evenodd",d:"M8.75 16.5A1.75 1.75 0 0 0 10.5 14.75v-1.5H9v1.5a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-1.5H5.5v1.5A1.75 1.75 0 0 0 7.25 16.5h1.5Z",clipRule:"evenodd"}),e.jsx("path",{d:"M8 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-7Z"})]}),W=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})}),Y=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 text-blue-500",children:e.jsx("path",{fillRule:"evenodd",d:"M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z",clipRule:"evenodd"})}),q=({modes:a,selectedMode:h,onSelect:v})=>{const[o,x]=n.useState(!1),d=n.useRef(null);n.useEffect(()=>{const l=w=>{d.current&&!d.current.contains(w.target)&&x(!1)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[]);const g=l=>{v(l),x(!1)};return e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("button",{onClick:()=>x(!o),className:"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors","aria-haspopup":"true","aria-expanded":o,children:[e.jsx(z,{}),e.jsx("span",{children:h.name}),e.jsx(W,{})]}),o&&e.jsx("div",{className:"absolute top-full right-0 mt-2 w-72 bg-gray-800 border border-gray-700 rounded-lg shadow-2xl z-20",children:e.jsx("div",{className:"p-2",children:a.map(l=>e.jsxs("div",{onClick:()=>g(l),className:"p-3 hover:bg-gray-700 rounded-md cursor-pointer",role:"option","aria-selected":h.id===l.id,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-white",children:l.name}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-600/30 text-blue-300 rounded-full",children:l.cost})]}),h.id===l.id&&e.jsx(Y,{})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:l.description})]},l.id))})})]})},J=()=>{const[a,h]=n.useState(null),[v,o]=n.useState(null),[x,d]=n.useState(!1),[g,l]=n.useState(null),[w,j]=n.useState(null),[A,y]=n.useState(""),[I,S]=n.useState("gemini-2.0-flash-exp"),C=n.useRef(null),R=r=>{var t;const i=(t=r.target.files)==null?void 0:t[0];if(i)if(h(i),l(null),j(null),i.type.startsWith("image/")){const s=new FileReader;s.onload=m=>{var u;o((u=m.target)==null?void 0:u.result)},s.readAsDataURL(i)}else o(null)},M=()=>{var t;const r=(t=E.extractionSettings)==null?void 0:t.delimiter,i=E.columns.map(s=>s.name).join(r);return`Ти си експерт по извличане на данни от фактури и счетоводни документи за българската счетоводна система (Плюс Минус).

КОНТЕКСТ:
- Потребителят подава ЕИК (регистрационен номер) на фирмата, за която се анализира документа. Този ЕИК ще наричаме ЕИК_ФИРМА.
- ЕИК_ФИРМА в този разговор е: ${A||"[ЕИК_ФИРМА не е подаден – ако не можеш еднозначно да определиш ролята на фирмата, не създавай ред]"}.

ЗАДАЧА:
Извлечи всички релевантни данни от предоставения документ (фактура/известие/трансфер) и върни резултата в CSV формат, съвместим със спецификацията във файла-описание.

CSV ФОРМАТ:
- Разделител между колоните: "${r}"
- Разделител на редовете: CRLF (\\r\\n)
- НЯМА заглавен ред – само редове с данни
- Кодиране: Windows-1251 (но можеш да работиш логически с UTF-8 – важно е съдържанието да е коректно на кирилица)

КОЛОНИ (${E.columns.length} общо, винаги в този ред):
${i}

ВАЖНИ ПРАВИЛА ЗА ЛОГИКАТА:
${E.extractionInstructions.map((s,m)=>`${m+1}. ${s}`).join(`
`)}

ВАЛИДАЦИЯ:
${Object.entries(E.validationRules).map(([s,m])=>`- ${s}: ${m}`).join(`
`)}

СПЕЦИАЛНИ БЕЛЕЖКИ:
- Всеки ред в CSV трябва да съдържа ТОЧНО ${E.columns.length} стойности, разделени с "${r}".
- Ако за колона няма данни, остави празно поле между разделителите (напр. ;;).
- Не използвай символи " ' / \\ & в текстови полета.
- Числата не трябва да съдържат валутни символи (лв., €, $ и др.).
- Всички дати трябва да са във формат dd.mm.yyyy.

ИЗХОД:
Върни САМО CSV данните, без допълнителен текст, обяснения или markdown форматиране.
Започни директно с редовете с данни (БЕЗ заглавия).`},P=async()=>{if(a){d(!0),j(null),l(null);try{throw new Error("API ключът не е конфигуриран. Моля, добавете VITE_API_KEY в .env файла.")}catch(r){console.error(r),j(r instanceof Error?r.message:"Възникна грешка при обработката на документа. Моля, опитайте отново.")}finally{d(!1)}}},$=()=>{if(!g)return;const r=new Blob([g.csv],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),t=URL.createObjectURL(r);i.setAttribute("href",t),i.setAttribute("download",g.fileName),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},D=()=>{h(null),o(null),l(null),j(null),y(""),C.current&&(C.current.value="")};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Извличане на данни от фактури"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Качете PDF или изображение на фактура за автоматично извличане на данни в CSV формат."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"Gemini Модел"}),e.jsxs("select",{value:I,onChange:r=>S(r.target.value),className:"w-full px-3 py-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"gemini-2.0-flash-exp",children:"Gemini 2.0 Flash (Experimental) - Най-бърз"}),e.jsx("option",{value:"gemini-1.5-flash",children:"Gemini 1.5 Flash - Стабилен, бърз"}),e.jsx("option",{value:"gemini-1.5-pro",children:"Gemini 1.5 Pro - По-мощен"}),e.jsx("option",{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash - Нов, бърз"}),e.jsx("option",{value:"gemini-2.5-pro",children:"Gemini 2.5 Pro - Най-мощен"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Flash моделите са по-бързи и евтини, Pro моделите са по-точни но по-скъпи"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-300 mb-1",children:"ЕИК на фирмата, за която се анализира документа (ЕИК_ФИРМА)"}),e.jsx("input",{type:"text",value:A,onChange:r=>y(r.target.value),placeholder:"Напр. 203287066",className:"w-full px-3 py-2 rounded-lg bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Използва се, за да се определи дали документът е продажба или покупка и кой е партньорът."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:C,type:"file",accept:"image/*,.pdf",onChange:R,className:"hidden"}),e.jsx("button",{onClick:()=>{var r;return(r=C.current)==null?void 0:r.click()},disabled:x,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:a?"Смени файла":"Избери файл"})]}),a&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify между mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(a.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:D,className:"text-red-400 hover:text-red-300 text-sm",children:"Премахни"})]}),v&&e.jsx("img",{src:v,alt:"Preview",className:"max-w-full max-h-96 rounded-lg mx-auto"})]}),a&&!g&&e.jsx("button",{onClick:P,disabled:x,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:x?"Обработва се...":"Извлечи данни"}),w&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-200",children:w})}),g&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-500 rounded-lg",children:e.jsx("p",{className:"text-green-200 font-medium",children:"✓ Данните са извлечени успешно!"})}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"CSV преглед:"}),e.jsx("pre",{className:"text-xs text-gray-300 overflow-x-auto bg-gray-900 p-3 rounded max-h-96 overflow-y-auto",children:g.csv})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:$,className:"flex-1 py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Изтегли CSV"}),e.jsx("button",{onClick:D,className:"flex-1 py-3 px-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"Нов документ"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"Поддържани формати:"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"• PDF документи"}),e.jsx("li",{children:"• Изображения (JPG, PNG, WEBP)"}),e.jsx("li",{children:"• Фактури продажба/покупка"}),e.jsx("li",{children:"• Дебитни и кредитни известия"}),e.jsx("li",{children:"• Документи тип Трансфер (вид 8)"})]})]})]})},Q=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12 4a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-2.5 6.5a2.5 2.5 0 1 0 5 0 2.5 2.5 0 0 0-5 0ZM12 1a9 9 0 0 0-9 9v6.5a2.5 2.5 0 0 0 2.5 2.5h13A2.5 2.5 0 0 0 21 16.5V10a9 9 0 0 0-9-9Zm7 15.5H5a.5.5 0 0 1-.5-.5V10a7 7 0 0 1 14 0v6a.5.5 0 0 1-.5.5Z",clipRule:"evenodd"})}),X=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12 6a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7Zm-5.5 9.5a1.5 1.5 0 0 1 1.5-1.5h8a1.5 1.5 0 0 1 1.5 1.5v.055A7.002 7.002 0 0 1 12 20a7.002 7.002 0 0 1-5.5-2.445V15.5ZM12 4a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11Z",clipRule:"evenodd"})}),ee=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6",children:e.jsx("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"})}),te=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"})}),Z=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{fillRule:"evenodd",d:"M18.97 3.659a2.25 2.25 0 0 0-3.182 0l-10.94 10.94a3.75 3.75 0 1 0 5.304 5.303l7.693-7.693a.75.75 0 0 1 1.06 1.06l-7.693 7.693a5.25 5.25 0 1 1-7.424-7.424l10.939-10.94a3.75 3.75 0 1 1 5.303 5.304L9.097 18.835l-.008.008-.007.007-.002.002-.003.002A2.25 2.25 0 0 1 5.91 15.66l7.81-7.81a.75.75 0 0 1 1.061 1.06l-7.81 7.81a.75.75 0 0 0 1.054 1.068L18.97 6.84a2.25 2.25 0 0 0 0-3.182Z",clipRule:"evenodd"})}),K=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:e.jsx("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})}),se=()=>e.jsxs("div",{className:"flex items-center space-x-1.5",children:[e.jsx("div",{className:"h-2 w-2 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),e.jsx("div",{className:"h-2 w-2 bg-gray-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),e.jsx("div",{className:"h-2 w-2 bg-gray-400 rounded-full animate-bounce"})]}),ae=({message:a,isLoading:h,isStreaming:v})=>{const o=a.role==="user";return a.role==="system"?e.jsx("div",{className:"text-center text-sm text-gray-500 my-4 italic",children:a.text}):e.jsxs("div",{className:`flex items-start gap-3 ${o?"justify-end":""}`,children:[!o&&e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex-shrink-0 flex items-center justify-center mt-1",children:e.jsx(Q,{})}),e.jsxs("div",{className:`max-w-xl w-fit p-3 rounded-2xl ${o?"chat-bubble-gradient text-white rounded-br-lg":"bg-gray-700 text-gray-200 rounded-bl-lg"}`,children:[a.files&&a.files.length>0&&e.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:a.files.map((d,g)=>e.jsx("div",{className:"relative",children:d.preview?e.jsx("img",{src:d.preview,alt:d.name,className:"max-w-xs max-h-48 rounded-lg"}):e.jsxs("div",{className:"bg-gray-600 px-3 py-2 rounded-lg text-sm flex items-center gap-2",children:[e.jsx(Z,{}),e.jsx("span",{className:"truncate max-w-[200px]",children:d.name})]})},g))}),e.jsxs("p",{className:"whitespace-pre-wrap break-words",children:[a.text,h&&v&&!o&&e.jsx("span",{className:"inline-block w-1 h-4 bg-white animate-pulse ml-1 align-middle","aria-label":"typing indicator"})]}),h&&!v&&!o&&e.jsx(se,{})]}),o&&e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex-shrink-0 flex items-center justify-center mt-1",children:e.jsx(X,{})})]})};function le(){const a={id:"init",role:"system",text:"Session started. Type a message to begin chatting with Gemini."},[h,v]=n.useState("chat"),[o,x]=n.useState([a]),[d,g]=n.useState(""),[l,w]=n.useState(!1),[j,A]=n.useState(V[0]),[y,I]=n.useState([]),S=n.useRef(null),C=n.useRef(null),R=n.useRef(null),M=n.useRef(null);n.useEffect(()=>{var t;(t=C.current)==null||t.scrollTo({top:C.current.scrollHeight,behavior:"smooth"})},[o]),n.useEffect(()=>{R.current&&(R.current.style.height="auto",R.current.style.height=`${R.current.scrollHeight}px`)},[d]);const P=()=>{S.current=null,x([a]),w(!1)},$=t=>{t.id!==j.id&&(A(t),S.current=null,x([{id:"mode-change-"+Date.now(),role:"system",text:`Model changed to ${t.name}. A new chat session has started.`}]),w(!1))},D=async t=>{const s=t.target.files;if(!s||s.length===0)return;const m=[];for(let u=0;u<s.length;u++){const c=s[u],b=new FileReader;await new Promise(N=>{b.onload=f=>{var L;const p=(L=f.target)==null?void 0:L.result,k=p.split(",")[1],F={name:c.name,type:c.type,data:k};c.type.startsWith("image/")&&(F.preview=p),m.push(F),N()},b.readAsDataURL(c)})}I(u=>[...u,...m]),M.current&&(M.current.value="")},r=t=>{I(s=>s.filter((m,u)=>u!==t))},i=async t=>{t.preventDefault();const s=d.trim();if(!s&&y.length===0||l)return;const m={id:Date.now().toString(),role:"user",text:s||"(attached files)",files:y.length>0?[...y]:void 0};x(c=>[...c,m]),g(""),I([]),w(!0);const u=(Date.now()+1).toString();x(c=>[...c,{id:u,role:"model",text:""}]);try{if(!S.current)throw new Error("API_KEY is not set. Please ensure VITE_API_KEY is configured in your .env file.");let c;if(m.files&&m.files.length>0){const f=[];s&&f.push({text:s}),m.files.forEach(p=>{f.push({inlineData:{mimeType:p.type,data:p.data}})}),c={message:f}}else c={message:s};const b=await S.current.sendMessageStream(c);let N="";for await(const f of b)N+=f.text,x(p=>p.map(k=>k.id===u?{...k,text:N}:k))}catch(c){console.error(c);const b=c instanceof Error?c.message:"An unknown error occurred.",N={id:"error-"+Date.now(),role:"system",text:`Error: ${b}. Please check your API key configuration.`};x(f=>f.filter(p=>p.id!==u).concat(N))}finally{w(!1)}};return e.jsxs("div",{className:"bg-gray-900 text-gray-200 h-full flex flex-col antialiased",children:[e.jsxs("header",{className:"p-4 border-b border-gray-800 bg-gray-900/80 backdrop-blur-sm sticky top-0 z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-lg font-bold text-white",children:"Gemini Chat"}),e.jsx("div",{className:"flex items-center gap-4",children:h==="chat"&&e.jsxs(e.Fragment,{children:[e.jsx(q,{modes:V,selectedMode:j,onSelect:$}),e.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(te,{}),"New Chat"]})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v("chat"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${h==="chat"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Chat"}),e.jsx("button",{onClick:()=>v("invoice"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${h==="invoice"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Invoice Extractor"})]})]}),h==="chat"?e.jsxs(e.Fragment,{children:[e.jsx("main",{ref:C,className:"flex-1 p-4 md:p-6 overflow-y-auto space-y-6",children:o.map((t,s)=>e.jsx(ae,{message:t,isLoading:l&&s===o.length-1,isStreaming:t.text.length>0},t.id))}),e.jsx("footer",{className:"p-4 md:p-6 border-t border-gray-800 bg-gray-900",children:e.jsxs("form",{onSubmit:i,className:"max-w-3xl mx-auto",children:[y.length>0&&e.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:y.map((t,s)=>e.jsx("div",{className:"relative group",children:t.preview?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.preview,alt:t.name,className:"h-20 w-20 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>r(s),className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(K,{})})]}):e.jsxs("div",{className:"relative bg-gray-700 px-3 py-2 rounded-lg text-sm flex items-center gap-2",children:[e.jsx(Z,{}),e.jsx("span",{className:"truncate max-w-[150px]",children:t.name}),e.jsx("button",{type:"button",onClick:()=>r(s),className:"ml-2 text-red-400 hover:text-red-300",children:e.jsx(K,{})})]})},s))}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsx("input",{ref:M,type:"file",multiple:!0,accept:"image/*,.pdf,.txt,.doc,.docx",onChange:D,className:"hidden","aria-label":"File input"}),e.jsx("button",{type:"button",onClick:()=>{var t;return(t=M.current)==null?void 0:t.click()},disabled:l,className:"w-12 h-12 rounded-full bg-gray-700 hover:bg-gray-600 flex items-center justify-center transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Attach file",children:e.jsx(Z,{})}),e.jsx("div",{className:"flex-1 bg-gray-800 rounded-2xl p-1 flex items-end",children:e.jsx("textarea",{ref:R,value:d,onChange:t=>g(t.target.value),onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),i(t))},placeholder:"Message Gemini...",className:"w-full bg-transparent p-2 resize-none border-none focus:ring-0 focus:outline-none placeholder-gray-500 max-h-48",rows:1,disabled:l,"aria-label":"Chat input"})}),e.jsx("button",{type:"submit",disabled:l||!d.trim()&&y.length===0,className:"w-12 h-12 rounded-full flex items-center justify-center transition-colors disabled:opacity-50 disabled:cursor-not-allowed chat-bubble-gradient text-white","aria-label":"Send message",children:e.jsx(ee,{})})]})]})})]}):e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsx(J,{})})]})}const _=document.getElementById("root");_&&O.createRoot(_).render(e.jsx(U.StrictMode,{children:e.jsx(le,{})}));
