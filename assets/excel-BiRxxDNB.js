import{r as x,j as e,G as H,O as Q,i as I,c as X,R as Y}from"./invoice-extraction-config-D31rbuU7.js";const Z=()=>{const[h,G]=x.useState([]),[f,b]=x.useState(!1),[y,k]=x.useState(null),[F,r]=x.useState(null),[A,w]=x.useState(""),[_,N]=x.useState(""),[c,j]=x.useState("gemini"),[O,S]=x.useState("gemini-2.0-flash-exp"),[T,p]=x.useState(!1),[C,B]=x.useState(""),$=x.useRef(null);x.useEffect(()=>{if(typeof Office<"u")Office.onReady(()=>{K()});else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("openai_api_key"),i=localStorage.getItem("ai_provider"),n=localStorage.getItem("gemini_model");t&&w(t),s&&N(s),i&&j(i),n&&S(n),!t&&!s&&p(!0)}},[]);const K=()=>{try{if(typeof Office<"u"&&Office.context&&Office.context.roamingSettings){const t=Office.context.roamingSettings.get("gemini_api_key"),s=Office.context.roamingSettings.get("openai_api_key"),i=Office.context.roamingSettings.get("ai_provider"),n=Office.context.roamingSettings.get("gemini_model");t&&w(t),s&&N(s),i&&j(i),n&&S(n),!t&&!s&&p(!0)}else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("openai_api_key"),i=localStorage.getItem("ai_provider"),n=localStorage.getItem("gemini_model");t&&w(t),s&&N(s),i&&j(i),n&&S(n),!t&&!s&&p(!0)}}catch(t){console.error("Error loading API keys:",t),p(!0)}},U=(t,s,i,n)=>{try{typeof Office<"u"&&Office.context&&Office.context.roamingSettings?(t&&Office.context.roamingSettings.set("gemini_api_key",t),s&&Office.context.roamingSettings.set("openai_api_key",s),Office.context.roamingSettings.set("ai_provider",i),Office.context.roamingSettings.set("gemini_model",n),Office.context.roamingSettings.saveAsync(l=>{l.status===Office.AsyncResultStatus.Succeeded?(t&&w(t),s&&N(s),j(i),S(n),p(!1),r(null)):r("Failed to save API keys")})):(t&&(localStorage.setItem("gemini_api_key",t),w(t)),s&&(localStorage.setItem("openai_api_key",s),N(s)),localStorage.setItem("ai_provider",i),localStorage.setItem("gemini_model",n),j(i),S(n),p(!1),r(null))}catch(l){console.error("Error saving API keys:",l),r("Failed to save API keys")}},z=async t=>{const s=t.target.files;if(!s||s.length===0)return;k(null),r(null);const i=[];for(let n=0;n<s.length;n++){const l=s[n];let o=null;l.type.startsWith("image/")&&(o=await new Promise(d=>{const m=new FileReader;m.onload=v=>{var g;d((g=v.target)==null?void 0:g.result)},m.readAsDataURL(l)})),i.push({file:l,preview:o})}G(n=>[...n,...i])},V=t=>{var l,o;const s=(l=I.extractionSettings)==null?void 0:l.delimiter,i=(o=I.extractionSettings)==null?void 0:o.minimumColumns,n=I.columns.slice(0,i).map((d,m)=>`${m+1}. ${d.name} - ${d.description}`).join(`
`);return`–¢–∏ —Å–∏ –µ–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ CSV —Ñ–∞–π–ª–æ–≤–µ –∑–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞.

–í–ê–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è: ${t}
- –ò–∑–ø–æ–ª–∑–≤–∞–π —Ç–æ–∑–∏ –ï–ò–ö, –∑–∞ –¥–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—à —Ç–∏–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

–û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê –¢–ò–ü –î–û–ö–£–ú–ï–ù–¢:
1. –ù–∞–º–µ—Ä–∏ –ï–ò–ö –Ω–∞ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞
2. –ù–∞–º–µ—Ä–∏ –ï–ò–ö –Ω–∞ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞
3. –°—Ä–∞–≤–Ω–∏ —Å –ï–ò–ö –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è (${t}):
   - –ê–∫–æ ${t} = –ï–ò–ö –Ω–∞ –ò–ó–î–ê–¢–ï–õ ‚Üí –ö–æ–ª–æ–Ω–∞ 1 = "–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞"
   - –ê–∫–æ ${t} = –ï–ò–ö –Ω–∞ –ü–û–õ–£–ß–ê–¢–ï–õ ‚Üí –ö–æ–ª–æ–Ω–∞ 1 = "–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞"
   - –ê–∫–æ ${t} –ù–ï —Å–µ –Ω–∞–º–∏—Ä–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Üí –ü–†–û–ü–£–°–ù–ò —Ç–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç (–Ω–µ –≥–æ –æ–±—Ä–∞–±–æ—Ç–≤–∞–π)

–ó–ê–î–ê–ß–ê:
–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –≤—ä—Ä–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –≤ CSV —Ñ–æ—Ä–º–∞—Ç.

CSV –§–û–†–ú–ê–¢:
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ –∫–æ–ª–æ–Ω–∏: "${s}"
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ —Ä–µ–¥–æ–≤–µ: –Ω–æ–≤ —Ä–µ–¥
- –ë–ï–ó –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥ (—Å–∞–º–æ –¥–∞–Ω–Ω–∏)
- –ö–æ–¥–∏—Ä–∞–Ω–µ: UTF-8
- –í—Å–µ–∫–∏ —Ä–µ–¥ = –ï–î–ò–ù –¥–æ–∫—É–º–µ–Ω—Ç

–ö–û–õ–û–ù–ò (–ú–ò–ù–ò–ú–£–ú ${i} –∫–æ–ª–æ–Ω–∏):
${n}

–í–ê–ñ–ù–ò –ü–†–ê–í–ò–õ–ê:
1. –í–ò–ù–ê–ì–ò –∏–∑–≤–µ–∂–¥–∞–π –ú–ò–ù–ò–ú–£–ú ${i} –∫–æ–ª–æ–Ω–∏ (–∫–æ–ª–æ–Ω–∏ 1-${i}).
2. –ê–∫–æ –∏–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–æ–Ω–∏ —Å–ª–µ–¥ ${i}, –¥–æ–±–∞–≤–∏ –≥–∏.
3. –ê–∫–æ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ —è –ø—Ä–∞–∑–Ω–∞ (–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ "${s}").
4. –ö–æ–ª–æ–Ω–∞ 1 (–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ) –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ "–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞" –∏–ª–∏ "–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞" —Å–ø–æ—Ä–µ–¥ –≥–æ—Ä–Ω–∞—Ç–∞ –ª–æ–≥–∏–∫–∞.
5. –ê–∫–æ –ï–ò–ö –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è (${t}) –ù–ï —Å–µ –Ω–∞–º–∏—Ä–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –ù–ï –∏–∑–≤–µ–∂–¥–∞–π –Ω–∏—â–æ –∑–∞ —Ç–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç.
6. –î–∞—Ç–∏—Ç–µ —Å–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy.
7. –ß–∏—Å–ª–∞—Ç–∞ —Å–∞ –±–µ–∑ –≤–∞–ª—É—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏.
8. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\ & –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞.

–î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ò–ù–°–¢–†–£–ö–¶–ò–ò:
${I.extractionInstructions.map((d,m)=>`${m+1}. ${d}`).join(`
`)}

–ò–ó–•–û–î:
–í—ä—Ä–Ω–∏ –°–ê–ú–û CSV –¥–∞–Ω–Ω–∏—Ç–µ, –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç, –æ–±—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ markdown —Ñ–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–µ.
–ó–∞–ø–æ—á–Ω–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å —Ä–µ–¥/—Ä–µ–¥–æ–≤–µ —Å –¥–∞–Ω–Ω–∏ (–ë–ï–ó –∑–∞–≥–ª–∞–≤–∏—è).
–í—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –ú–ò–ù–ò–ú–£–ú ${i} —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏ —Å "${s}".
–ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –Ω–µ —Å—ä–¥—ä—Ä–∂–∞ –ï–ò–ö ${t}, –Ω–µ –∏–∑–≤–µ–∂–¥–∞–π –Ω–∏—â–æ –∑–∞ –Ω–µ–≥–æ.`},W=async()=>{var s;if(h.length===0)return;if(!C.trim()){r("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞");return}const t=c==="gemini"?A:_;if(!t){r(`–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ ${c==="gemini"?"Gemini":"OpenAI"} API –∫–ª—é—á`),p(!0);return}b(!0),r(null),k(null);try{const i=[];for(let l=0;l<h.length;l++){const{file:o}=h[l],d=new FileReader,m=await new Promise((a,u)=>{d.onload=D=>{var M;const q=((M=D.target)==null?void 0:M.result).split(",")[1];a(q)},d.onerror=u,d.readAsDataURL(o)}),v=V(C.trim());let g="";c==="gemini"?g=((await new H({apiKey:t}).chats.create({model:O}).sendMessage({message:[{text:v},{inlineData:{mimeType:o.type,data:m}}]})).text||"").trim():g=((await new Q({apiKey:t,dangerouslyAllowBrowser:!0}).chat.completions.create({model:"gpt-4o-mini",messages:[{role:"user",content:[{type:"text",text:v},{type:"image_url",image_url:{url:`data:${o.type};base64,${m}`}}]}],max_tokens:4096})).choices[0].message.content||"").trim(),g.startsWith("```")&&(g=g.replace(/```csv\n?/gi,"").replace(/```\n?/g,"").trim());const E=((s=I.extractionSettings)==null?void 0:s.delimiter)||";";g.split(/\r?\n/).filter(a=>a.trim().length>0).forEach(a=>{const u=a.split(E);u.length>0&&u[0].trim()&&i.push(u)})}if(i.length===0){r("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –∏–∑–≤–ª–∏—á–∞–Ω–µ. –£–≤–µ—Ä–µ—Ç–µ —Å–µ, —á–µ –ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ —Å–µ –Ω–∞–º–∏—Ä–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ."),b(!1);return}const n=`invoices_${Date.now()}.csv`;k({rows:i,fileName:n})}catch(i){console.error(i),r(i instanceof Error?i.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ")}finally{b(!1)}},L=async()=>{if(!y){r("–ù—è–º–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏ –¥–∞–Ω–Ω–∏");return}if(typeof Excel>"u"){r("Excel API –Ω–µ –µ –¥–æ—Å—Ç—ä–ø–µ–Ω. –ú–æ–ª—è, —É–≤–µ—Ä–µ—Ç–µ —Å–µ, —á–µ –¥–æ–±–∞–≤–∫–∞—Ç–∞ —Ä–∞–±–æ—Ç–∏ –≤ Excel.");return}try{b(!0),await Excel.run(async t=>{const s=t.workbook.worksheets.getActiveWorksheet();let i=0,n=!1;try{const a=s.getUsedRange();a.load(["rowCount","rowIndex","address"]),await t.sync(),a.rowCount===0?(n=!0,i=0):i=a.rowIndex+a.rowCount}catch{i=0,n=!0}const l=y.rows;if(l.length===0){r("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –¥–æ–±–∞–≤—è–Ω–µ"),b(!1);return}const o=Math.max(...l.map(a=>a.length)),d=I.columns.slice(0,o).map(a=>a.name),m=l.map(a=>{const u=[...a];for(;u.length<o;)u.push("");return u}),v=0;if(n){const a=s.getRangeByIndexes(0,v,1,o);a.values=[d],a.format.font.bold=!0,a.format.fill.color="#4472C4",a.format.font.color="#FFFFFF",await t.sync(),i=1}const g=s.getRangeByIndexes(i,v,m.length,o);g.values=m,g.format.autofitColumns(),await t.sync(),r(null),b(!1),k(null),G([]);const E=`–£—Å–ø–µ—Ö! ${l.length} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –Ω–∞ —Ä–µ–¥ ${i+1}.`,P=document.createElement("div");P.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",P.textContent=E,document.body.appendChild(P),setTimeout(()=>{document.body.removeChild(P)},3e3)})}catch(t){console.error("Error writing to Excel:",t),b(!1),r("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ –≤ Excel: "+(t instanceof Error?t.message:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ –≥—Ä–µ—à–∫–∞"))}},J=t=>{G(s=>s.filter((i,n)=>n!==t))},R=()=>{G([]),k(null),r(null),$.current&&($.current.value="")};return T?e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ AI Provider"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ò–∑–±–µ—Ä–µ—Ç–µ AI –º–æ–¥–µ–ª –∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Å—ä–æ—Ç–≤–µ—Ç–Ω–∏—è API –∫–ª—é—á. –ö–ª—é—á–æ–≤–µ—Ç–µ —â–µ –±—ä–¥–∞—Ç –∑–∞–ø–∞–∑–µ–Ω–∏ –ª–æ–∫–∞–ª–Ω–æ –Ω–∞ –≤–∞—à–µ—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-3",children:"–ò–∑–±–µ—Ä–µ—Ç–µ AI Provider:"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"provider",value:"gemini",checked:c==="gemini",onChange:t=>j(t.target.value),className:"w-4 h-4"}),e.jsx("span",{className:"text-white",children:"Google Gemini"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"provider",value:"openai",checked:c==="openai",onChange:t=>j(t.target.value),className:"w-4 h-4"}),e.jsx("span",{className:"text-white",children:"OpenAI GPT-4o Mini"})]})]})]}),c==="gemini"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini –ú–æ–¥–µ–ª:"}),e.jsxs("select",{value:O,onChange:t=>S(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"gemini-2.0-flash-exp",children:"Gemini 2.0 Flash (Experimental) - –ù–∞–π-–±—ä—Ä–∑"}),e.jsx("option",{value:"gemini-2.0-pro-exp",children:"Gemini 2.0 Pro (Experimental) - –ú–æ—â–µ–Ω, –Ω–æ–≤"}),e.jsx("option",{value:"gemini-1.5-flash",children:"Gemini 1.5 Flash - –°—Ç–∞–±–∏–ª–µ–Ω, –±—ä—Ä–∑"}),e.jsx("option",{value:"gemini-1.5-pro",children:"Gemini 1.5 Pro - –ü–æ-–º–æ—â–µ–Ω"}),e.jsx("option",{value:"gemini-2.5-flash",children:"Gemini 2.5 Flash - –ù–æ–≤, –±—ä—Ä–∑"}),e.jsx("option",{value:"gemini-2.5-pro",children:"Gemini 2.5 Pro - –ù–∞–π-–º–æ—â–µ–Ω"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Flash –º–æ–¥–µ–ª–∏—Ç–µ —Å–∞ –ø–æ-–±—ä—Ä–∑–∏ –∏ –µ–≤—Ç–∏–Ω–∏, Pro –º–æ–¥–µ–ª–∏—Ç–µ —Å–∞ –ø–æ-—Ç–æ—á–Ω–∏ –Ω–æ –ø–æ-—Å–∫—ä–ø–∏"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["Gemini API Key:",c==="gemini"&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("input",{id:"gemini-key",type:"password",value:A,onChange:t=>w(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á...",className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["–ü–æ–ª—É—á–µ—Ç–µ –æ—Ç: ",e.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 underline",children:"Google AI Studio"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["OpenAI API Key:",c==="openai"&&e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("input",{id:"openai-key",type:"password",value:_,onChange:t=>N(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ OpenAI API –∫–ª—é—á...",className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["–ü–æ–ª—É—á–µ—Ç–µ –æ—Ç: ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 underline",children:"OpenAI Platform"})]})]}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("button",{onClick:()=>{if(!(c==="gemini"?A:_).trim()){r(`–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ ${c==="gemini"?"Gemini":"OpenAI"} API –∫–ª—é—á`);return}U(A,_,c,O)},className:"flex-1 py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"üíæ –ó–∞–ø–∞–∑–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"}),(A||_)&&e.jsx("button",{onClick:()=>p(!1),className:"flex-1 py-3 px-4 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"‚Üê –ù–∞–∑–∞–¥"})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-900/30 border border-blue-500 rounded-lg",children:e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –º–æ–¥–µ–ª–∏—Ç–µ:"}),e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"Gemini:"})," –ü–æ-–µ–≤—Ç–∏–Ω (~$0.001 –Ω–∞ —Ñ–∞–∫—Ç—É—Ä–∞), –ø–æ-–±—ä—Ä–∑",e.jsx("br",{}),"‚Ä¢ ",e.jsx("strong",{children:"OpenAI:"})," –ü–æ-—Å–∫—ä–ø (~$0.01 –Ω–∞ —Ñ–∞–∫—Ç—É—Ä–∞), GPT-4o Mini –º–æ–¥–µ–ª",e.jsx("br",{}),e.jsx("br",{}),"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ –∫–ª—é—á–æ–≤–µ –∏ –∑–∞ –¥–≤–∞—Ç–∞ –º–æ–¥–µ–ª–∞ –∏ –¥–∞ –ø—Ä–µ–≤–∫–ª—é—á–≤–∞—Ç–µ –º–µ–∂–¥—É —Ç—è—Ö."]})})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["–ú–æ–¥–µ–ª: ",e.jsx("span",{className:"text-blue-400 font-medium",children:c==="gemini"?`ü§ñ ${O.replace("gemini-","Gemini ").replace("-exp"," (Exp)").replace("-"," ").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}`:"üß† OpenAI GPT-4o Mini"})]})]}),e.jsx("button",{onClick:()=>p(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"‚öôÔ∏è API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ö–∞—á–µ—Ç–µ –µ–¥–∏–Ω –∏–ª–∏ –ø–æ–≤–µ—á–µ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ñ–∞–∫—Ç—É—Ä–∏ –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏."}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–ï–ò–ö –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:C,onChange:t=>B(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ –ï–ò–ö –Ω–∞ –≤–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞...",className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:f}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ï–ò–ö-—ä—Ç —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—è–Ω–µ –¥–∞–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ —Ñ–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞ –∏–ª–∏ –ø—Ä–æ–¥–∞–∂–±–∞"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:$,type:"file",multiple:!0,accept:"image/*,.pdf",onChange:z,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=$.current)==null?void 0:t.click()},disabled:f,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:h.length>0?"–î–æ–±–∞–≤–∏ –æ—â–µ —Ñ–∞–π–ª–æ–≤–µ":"–ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ"})]}),h.length>0&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium",children:["–ò–∑–±—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ (",h.length,")"]}),e.jsx("button",{onClick:R,className:"text-red-400 hover:text-red-300 text-sm",children:"–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏"})]}),h.map((t,s)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.file.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.file.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:()=>J(s),className:"text-red-400 hover:text-red-300 text-sm",children:"–ü—Ä–µ–º–∞—Ö–Ω–∏"})]}),t.preview&&e.jsx("img",{src:t.preview,alt:"Preview",className:"max-w-full max-h-48 rounded-lg mx-auto"})]},s))]}),h.length>0&&!y&&e.jsx("button",{onClick:W,disabled:f,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:f?`–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ... (${h.length} —Ñ–∞–π–ª–∞)`:"–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏"}),F&&e.jsx("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-200",children:F})}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-green-900/30 border border-green-500 rounded-lg",children:e.jsx("p",{className:"text-green-200 font-medium",children:"‚úì –î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏ —É—Å–ø–µ—à–Ω–æ!"})}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ:"}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("table",{className:"text-xs text-gray-300 w-full",children:e.jsx("tbody",{children:y.rows.slice(0,10).map((t,s)=>e.jsx("tr",{className:s===0?"font-bold bg-gray-800":"",children:t.map((i,n)=>e.jsx("td",{className:"border border-gray-600 px-2 py-1",children:i},n))},s))})}),y.rows.length>10&&e.jsxs("p",{className:"text-gray-400 text-xs mt-2",children:["... –∏ –æ—â–µ ",y.rows.length-10," —Ä–µ–¥–∞"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:L,disabled:f,className:"flex-1 py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:f?"‚è≥ –ó–∞–ø–∏—Å–≤–∞–Ω–µ...":"üìã –ö–æ–ø–∏—Ä–∞–π –≤ —Ç–∞–±–ª–∏—Ü–∞"}),e.jsx("button",{onClick:R,disabled:f,className:"flex-1 py-3 px-4 bg-gray-600 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:"üîÑ –ù–æ–≤–∏ —Ñ–∞–∫—Ç—É—Ä–∏"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"–ü–æ–¥–¥—ä—Ä–∂–∞–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏:"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"‚Ä¢ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏"}),e.jsx("li",{children:"‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, WEBP)"}),e.jsx("li",{children:"‚Ä¢ –§–∞–∫—Ç—É—Ä–∏ –∑–∞ —É—Å–ª—É–≥–∏"}),e.jsx("li",{children:"‚Ä¢ –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤–µ –Ω–∞–≤–µ–¥–Ω—ä–∂"})]})]})]})},ee=X.createRoot(document.getElementById("root"));ee.render(e.jsx(Y.StrictMode,{children:e.jsx("div",{className:"bg-gray-900 text-gray-200 h-full antialiased overflow-y-auto",children:e.jsx(Z,{})})}));
